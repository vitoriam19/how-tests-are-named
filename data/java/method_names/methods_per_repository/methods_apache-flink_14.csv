testClusterClientRetrievalOfFinishedYarnApplication(@TempDir
completesTerminationFutureExceptionallyIfActorStopsExceptionally()
testWarmUpIsFinished()
testAllApis('f3.floor(),
testReadBufferSkip()
testJobMasterDisconnectsOldTaskExecutorIfNewSessionIsSeen()
testSubplanReuse_DeadlockCausedByReusingExchangeInAncestor():
testRecoverableWriterWithViewfsScheme()
testSubGraph()
testDropTemporaryFunction()
testHarness.getOutput().size()
testSqlApi(s"IFNULL(REPLACE($str3,
testToString()
testSideOutputDueToLatenessSliding()
testCreateSubpartitionReader()
testProcessingTimeHopWindow():
testUidDefaults()
testOptionalClearingBuffer()
testHarness.endInput(1,
test_avro_map_read(self):
testSqlApi("SIGN(-1.1)",
testJobGraphRetrievalFailIfJobDirDoesNotHaveEntryClass()
testCleaningDuplicateEntryThrowsNoException()
testPurgeNamespace()
test_es_sink_key_none(self):
testNotRewriteLocalVariableInFunctionWithReturnValue()
testReleaseIfPhysicalSlotIsAllocated()
testEndsWithDelimiter()
notLeaderInformsAllRegisteredLeaderElectionEventHandlers()
testAllApis('f9.element(),
testAllApis('f5.power('f6),
testSqlApi("POWER(-1,
testStopWithSavepointWithMaxWatermark()
testIsReleasedChecksParent()
testAllApis('f18.ceil(TimeIntervalUnit.MINUTE),
verifyInputIndex2()
testTimesClearingBuffer()
testStrictlyMatchingAnyPartitioning()
testStreamFactory.setWaiterLatch(waiter);
testThatAnInvalidOptionIsInvalid()
testMissingEnvironmentVariableCredentials()
setAutoMax()
testGreedyOneOrMore()
testSerializationWithNettyShuffleDescriptor()
testAddDifferentResourceProfile()
testSkipListValueSerializer(i);
testTemporalLeftJoinLookupKeyContainsPk()
testBuildAdaptivePollingRecordPublisher()
testCross(ExecutionEnvironment
testInsertPartitionWithValuesSource()
testFromDataSet()
testBasicRead()
meterRateIsReportedAsPrometheusGauge()
testGetNewNodeIdIsThreadSafe()
serviceUrlAndAdminUrlMustBeProvided()
testWorksetIterationNotDependingOnSolutionSet()
testExecutionGraphArbitraryDopConstructionTest()
testForwardingSubtaskLocalStateBaseDirFromLocalStateStore()
testHarness.processWatermarkStatus2(WatermarkStatus.ACTIVE);
testIteratorOnMultiColumnEmptyBuffer(
testJsonRoundTrip(
testGetCredentialsProviderTypeDefaultsAuto()
testAllocationUpdatesIgnoredIfSlotMarkedAsPendingForOtherJob()
consumeMessageCreatedBeforeHandleSplitsChangesAndUseSecondLastMessageIdCursor(
selectAllocationBaseDir()
testRecursiveClass()
testIsAvailable(
testPutBufferTransientSuccessfulGet2()
testLeaseCloseIsIdempotent()
testNonForwardedInvalidTypes5()
testGetUserClassPath()
testCompilePlanOverwrite()
testGetSchemaAndDeserializedStream_withWrongSchema_throwsException()
testStoreDirtyJobResult()
testDataMatcher();
testTriggerCheckpointAsyncIsDecorated()
testPendingStateMatches()
testSqlExecuteWithSelect()
testValueScaleLimited()
testNestedSchemaConversion()
simpleTranspose()
testDisallowProgramConfigurationChanges(
temporaryTable()
testIgnoreError()
testForce()
testRegionUnfinishedMultipleTimes()
testSqlApi("IFNULL((f6
test_key_by_flat_map(self):
permanentBlobCacheTimesOutRecoveredBlobs(@TempDir
testConfig.setProperty(EFO_HTTP_CLIENT_MAX_CONCURRENCY,
testJobManagerLeaderRetrieval()
test_csv_primitive_column_write(self):
testStartUpPeriodAfterLeadershipSwitch()
testJoinNestedPojoAgainstTupleSelectedUsingString()
testAllApis('f0.get("intField"),
unexpectedResourceManagerTermination_ifNotRunning_doesNotFailFatally()
testNonForwardedNestedTuple()
testFilterPushDownAndReportStatisticsDisabled()
testAlterPythonFunction()
testBufferResponse(boolean
testQueryGeneric(
testNotSet()
testAllApis('f2.at("a").isNull,
testHashTableGrowthWithInsertOrReplace()
testTableViewExpansionWithMismatchRowType()
testMissingJobClassOnUserClasspathWithoutExplicitJobClassName()
writeFileReadMemoryBuffer()
testManagedMemoryMetricsInitialization()
testReplicatedSourceToCross()
testConfigOptionExclusion()
testJoinWithMixedKeyTypes2()
testMaxRetry()
testDynamicPartitionWriter()
testDeregisterStreamConsumer()
testErrorHandlerIsCalledWhenSubmissionThrowsAnException()
test_csv_use_escape_char(self):
testProcessingTimeSessionWindows(SHANGHAI_ZONE_ID);
testCreateKeyGroupPartitions(Short.MAX_VALUE,
testNoSkipWithFollowedByAny()
testPartialInsertWithReorder():
testKeyedCEPOperatorCheckpointingWithRocksDB()
testGetters(row);
deletePersistedSlotAllocationSnapshot()
testConsumeQuicklyWithNDataBuffers(0,
testMinCheckpointPause()
testBroadcastVariableSimple()
getOperatorStateStreams()
testComplexDataTypes()
testSortPartitionWithKeySelector3()
testHandleAddSplitsEvent()
testNoIdleTimeWhenBusy()
testDoubleProbeSpilling()
testDeserializeIgnoreComment()
testArray()
testApplyToWithSimpleOption()
testErrorCodeForUnknownJob()
testGetNioBuffer2()
testLess()
testUnion2()
testStreamPartitionReadByCreateTime()
testConstantRankRangeWithoutOffsetWithoutRowNumber()
testHarness.setProcessingTime(42);
testValidSslConnection(Configuration
testParseError()
testFailToConfirmCheckpointAborted()
testRecycleBufferForNotifyingSubpartitionView()
testAllApis('f0.repeat(0),
testCompressByName(String
testInvalidJoinHint():
testPluggableParser()
testNewFetcherIsIdle()
testSpec.getDefaultDatabase().ifPresent(tEnv::useDatabase);
testReadableBytes(boolean
testSpillingHashJoinOneRecursionValidityIntPair()
testBranchingWithMultipleDataSinks2()
testToFloatValue()
prepareSinkSavepoint()
testMigrationStrategyForRemovedAvroDependency()
testGroupByNonPrimaryKey():
testStreamPartitionReadByPartitionName()
testMinByRowTypeInfoKeyFieldsForUnsortedGrouping()
testDateType()
testTaskSubmission()
testSinkDisorderChangeLog():
testAvailableAfterNotifyAvailable()
test_basic_operations(self):
testField(Types.INT,
testAccumulatorResultWithoutCheckpoint(6,
testDynamicPropertiesWithParentFirstClassloader()
testLazyInstantiationOfPreviousSchemaSerializer()
testNettyMessageClientDecoding(true,
testLoadingListenersFromConfiguration()
testHarness.setProcessingTime(6001);
testHashPartitionByKeyFieldAndDifferentParallelism()
YEAR(2)))
testResolveUserDefinedValueWithNotDefinedInPodTemplate()
testCoLocationConstraintIsRespected()
testGroupFollowedByTimes()
testRemoveField()
testResultLessThanExpected()
testUnsupportedWindowTVF_TumbleOnProctime():
testMaxWeightAllNeighbors()
testAllApis('f17.floor(TimeIntervalUnit.SECOND),
testGetRestServiceExposedType()
testRow.setKind(RowKind.UPDATE_AFTER);
testSlotOffer()
testLoadingStateBackend(
testGetConsumers()
testWorkingDirectoryIsSetupWhenStartingTheClusterEntrypoint()
testAddFailureHandlingForSessionMovedException()
testPop()
testRequestKvStateOfWrongJob()
testSerializeDeserializeCustomizedProperties()
testSqlApi("rtrim(f8)",
testGetInvalidAbbreviationLocalTimeZone()
testBinaryRow()
testActiveTimeoutAfterAnnouncementPassiveTimeout()
testCloseWithoutOpen()
testExitNoRetries()
testUnionDiffRowTime():
testArchiveNonFailedExecutionWithArchiveFailedExecutionMethod()
testSpec.getCatalogManager();
testOverAggWithSortAgg()
testIterator()
testMergeWithInprogressFileSupportResume()
testSqlApi(s"CAST(${decimal_38_2(12.2)}
testGoToFinishedNotifiesJobListener()
testMissingFilePut()
testSerializePOJO_withValidParams_withCompression_succeeds()
testRequiredFields()
testBufferedTableSink()
testMinMaxWithTumblingWindow():
testDisposeDeletesFile()
testStreamTableEnvironmentExecutionExplain():
testWritingDocuments()
oneProviderThrowsExceptionMustFailFast()
testHarness.taskStateManager.getWaitForReportLatch().reset();
testStrictOneOrMore()
testBoundsCanBeExclusive()
testSqlApi("DATE
shouldSync()
testGroupAggregateInternal();
testBloomNumBits()
testReleaseMemoryOnPipelinedPartition()
testResolveSchemaCompatibilityWithCompatibleAfterMigrationFieldSerializers()
testPojoAllPublic()
testForPojoSerializability()
testOutputFormat.writeRecord("writeRecord
testDefaultPartitionName()
testGetRequestSlotMatchingStrategy()
testDeleteTransientAlreadyDeleted(null);
batchReduceSingleResultPerKey()
testCreateNettyAsyncHttpClientWithPropertyTcpKeepAlive()
testSetKey()
testCreateSlice2(false);
testDeleteBlob(
testZeroOrMore(Quantifier.ConsumingStrategy.STRICT);
testCancellationOfCanceledTerminalDoesNotThrowException()
testStringSerializability(nullableType,
testAllApis('f17.ceil(TimeIntervalUnit.MINUTE),
testTimesOrMoreStrictOptional()
testStartCommandWithLogAndJMOpts()
testRecoverSortedCheckpoints()
testJobMasterGatewayIsInvalidatedOnLeadershipChanges()
testHandleSplitChangesAndFetch()
testFreeSlot()
testConvertToPatternWithoutWildcards()
testPipelinedPartitionBufferPool()
testHeapMemoryPropertyWithOldConfigKey()
testLeftOuterJoinOnTuplesWithKeyPositions(JoinHint.REPARTITION_HASH_FIRST);
testFutureRemovedAfterCompletion()
testEmittingIdleAfterAllSplitsRemoved()
testPhysicallyRemoveDuringSyncPartOfSnapshot(
testGetBlobServerPort()
testLeftJoin()
testRecoveryWithAtLeastOnceGuarantee()
testCreateSharedResourcesWithExpectedCapacity()
testDeleteQuietly()
testLeftOuterJoinReorder():
testFailingCompletedCheckpointStoreAdd()
addingUnknownMetricTypeDoesNotThrowException()
testDualHashPartitioningPreserved()
test_enable_changelog_state_backend(self):
testIncreasingResourceRequirementsWillSendResourceRequirementNotification()
testPartitionByKeyGroupForSizeWithIterator(1,
testingRpcService.stopService();
shouldThrowIllegalArgumentExceptionIfDeliveryTimeoutWithUnitIsNegative()
testHarness.configureForKeyedStream(keySelector,
registerTopicPartitionsWillOnlyReturnNewPartitions()
testTransientBlobCacheGetStorageLocationConcurrent(new
testDeclineWithAsyncCheckpointExceptionWhenRunning()
testAllApis('f15.floor(),
testAllApis('f17
testAllApis('f29.truncate(),
testHarness.notifyOfCompletedCheckpoint(2L);
testingSlotProvider.allocateSlot(
testWithoutParallelism()
testCannotReserveBeyondTheLimit()
testNoNestedDirectoryTrue()
testExhausted()
testCancelMatchTaskWhileSort1()
testLeftOuterStrategy6()
testGetOperationFinishedAndFetchResults()
testFactory("s3");
testDeserializeWithMetadata()
testPreEmptiveUploadForMultipleBackends()
testTableSinkSemanticTranslation()
testPatternWithOrFilter()
testDiscardAfterReplaceFailureWithBadVersionException()
testDynamicFilteringWithStaticPartitionPruning()
testSwitchNeverEnabledToEnabled()
testRemoveDefaultMLEnvironment()
testSecurityFactoriesDefaultConfig()
testExecutionWithEmptyIteration()
testConnectionSuspendedHandling()
testingResourceManagerGateway.setNotifySlotAvailableConsumer(
testCustomizedWatermarkGenerator()
testValueStateDefaultValue()
testMultipleKubernetesLeaderElectors()
testWrapCopyEmpty()
testPurgeNamespaceWithSnapshot()
testHarness.getProcessingTimeService().setCurrentTime(0);
fetchTopicPartitionInformation()
testForward()
testDescribeSchema()
testProcessingTimeTimers()
testDelegateToCoGrouped()
testCommitAllCommittablesOnEndOfInput()
testDeleteTransientAlreadyDeletedNoJob()
testYarnIDOverridesPropertiesFile()
testSerializationRoundTrip(Util.randomRecords(numValues),
testReleasingAllocatedSlot()
testInvalidCredentialsProvider()
testCreateLocationPreferenceSlotSelectionStrategyForLocalRecoveryBatchJob()
testUnionInputOutputDifferentDOP()
testAllOptions()
testSlotProviderBatchSlotRequestTimeoutCheckIsDisabled()
testPerJobModeWithDefaultFileReplication()
testMigrationOfTypeWithAvroType()
testMinAndMaxAtRangeMaximumInclusive()
testGemvTransposeSizeCheck()
testSnapshotAndRestore(int
testStreamEmptyOuterCrossTask()
testCancelSortMatchWithHighparallelism()
testHash1LeftOuterJoinTask()
testOrder()
testDefaultKerberosKeytabConfiguration()
testMultiInputBroadcast()
testSqlApi("EXTRACT(ISODOW
testPythonExecutable()
testHarness.processElement2(insertRecord(13L,
testCreateTableFromDescriptor()
testAsyncCheckpointException()
testEnd()
testDisallowJobConfigurationChanges(
@Ignore("The
testThrowIfExactlyOnceConfigured()
testPodAnnotations()
testUninstantiatedTemporarySystemFunction()
testGetLegacyShuffleMode()
testFromSource():
testPactNull()
testAllApis('f4.cardinality(),
testPrimitiveEqualKeyAndDiffNamespace()
testRejectWhenSolutionSetKeysDontMatchCoGroup()
testNonPartition(@TempDir
testStateMapIteratorIllegalNextInvocation()
testClusterShutdownWhenApplicationSucceeds()
testRegisterResource()
testFailFuturesImmediately()
testDeprecationFlagForDeprecatedKeys()
testAllApis('f18.floor(TimeIntervalUnit.DAY),
testAddingPartiallyFinishedOperatorBeforeFinishedOneFails()
testTableAPIQuery():
testRetry()
testingRunner.completeJobMasterGatewayFuture(testingJobMasterGateway);
testExtractFromTimeZeroResult(TimeUnit.DECADE)
testOnContainerCompletedBecauseItWasPreempted()
testStopWithExplicitSavepointTypeShortOption()
testGetValidLogUrlPattern(pattern,
testSkipListValueSerializerBasicOp()
testShowViews()
testHasDirtyJobResultEntryWithNoDirtyEntry()
shouldSetDefaultValueIfConnectionTimeoutNotGiven()
testSwitchEnabledToDisabledImproperly()
testSuccessfulPut()
testCases.addAll(jsonArraySpec());
testIncludeFileWithCharacterSetMatcher()
mergeTheTopicNamesIntoOneSet()
testExceptionsNonIterativeReader()
testSequenceOfEvents(emitProgressiveWatermarks,
testOutputFormatUsesCorrectParallelism()
testCorrectTimestampPassingInContext(1L,
testConfigLegacyHeapMemory(Configuration
testSqlApi(timestampLtz("2018-03-14
testConcurrentLeadershipOperations()
testBlock1CrossTask()
testDeploymentSpec()
testUnsupportedPredOnly()
testPreparingCommitAtSnapshotTimeEnsuresBufferedRecordsArePersistedToDestination()
testSqlApi("CHAR_LENGTH(CAST(CURRENT_ROW_TIMESTAMP()
testLocalExecutionAttemptFailureAndForbiddenRestartWillFailJob()
testSendIsNotRetriableIfHttpNotFound()
testImperativeUdaf()
testMissingRequiredArgument()
testSubtractThisUnknown()
testCreateNettyAsyncHttpClientTcpKeepAlive()
testReadMultipleOutputPerKey()
testThrowExceptionWhenNotStarted()
testSplitting(NumberSequenceIterator
releaseCollectionAfterReleaseAll()
testNotifiesWhenGoingIdle()
testFailedToInitWithInvalidSslKeystoreConfigured()
testIntervalJoinOnTimestampLtzRowtime():
testWritingDocumentsWithDynamicIndexFromSystemTime()
testSimplePatternWithTimeoutHandlingWithinPreviousAndCurrent()
testAddVertices()
testParseStateTtlConfigFromProto()
testCorrectnessOfGroupReduceOnTuplesWithKeyFieldSelector()
test_collection_type_info(self):
testAvroByDefault()
testData.add(Tuple2.of(DataTypes.TIMESTAMP(9),
maxParallelismInvalid()
testCoGroupWithKeySelectorsWrongType()
testSetBothLocationAndFailureCause()
testFailedUpload()
testRetryFailureFixedRetries()
testTimerRegistrationAndCancellation()
testConcurrentGetAndIncrement()
testConnectMultipleTargets()
testJobDetailsMarshalling()
testListeningEventsFromOtherCoordinators()
testGetRequiredResources()
testCancelScheduledTask(
testReleaseAlsoReleasesLogicalSlots()
testHarness.configureForKeyedStream(value
testDisablingAutoUidsAcceptsManuallySetId()
testRemoveState()
addingTypesIsCompatibleAfterReconfiguration()
testChildFirstDefaultConfiguration()
closedGroupDoesNotRegisterMetrics()
testCloseWithoutTaskCommit()
testHarness.setProcessingTime(1615716000000L)
largeAvroSchemaSerialization()
testAddRemoteJar()
testApplicationDefinedChangelogStateBackend()
testExistingSecurityManagerRespected()
testFailedDelete()
testProcessEvictorWindowStateReader()
testTupleKeySelectorSortWithCombine()
testHarness.getTaskStateManager());
testIsNan()
testIdleAndBackPressuredTime()
test_avro_array_read(self):
unregisteredEventHandlersAreNotNotified()
testConfigKeysForwardingShortHadoopStyle()
testEventTimeTumblingWindows()
testExplainWithInsert()
testLowerUpperPushdown():
testResultFutureWithSuccessfulResultAfterStart(AFTER_START);
testSqlApi("SHA256(cast('test'
testReportFinishedOnRestoreTaskSnapshots()
setPropertiesCanNotOverrideExistedKeysWithNewValueAndSupportTypeConversion()
forwardFieldsTestMapReduce()
testPartialInsertWithDynamicPartitionAndComputedColumn1():
testCompressByName(
testSendCancelAndReceiveFail()
testStateRecoveryWhenTopologyChange()
grantLeadership_notStarted_doesNotStartNewRm()
testingHighAvailabilityServices.setJobResultStore(jobResultStore);
testWriteAndReadData(BoundedData
testPutBufferFailsStore(new
testConnectionTimeout()
testRestoreState()
testAllReduceDriverImmutable()
testInstance.add(5);
testNegativeExclusiveAndPositiveExlusive()
testAllApis(1.year,
testExecutionGraphIsDeployedInTopologicalOrder()
testPrimaryKeyValidation()
testEscapeDynamicPropertyValueWithDoubleQuote()
testSetSpec.testTableApiRuntimeError(
withDifferentSchema()
testAreCompatible2()
testSubclassException()
testCheckAndUpdateConfigMapWithEmptyResult()
testDeclineCheckpointWithUserExceptionCanBeDeserializedWithoutUserClass()
testClosingOfClassloader()
testPartitionNotFoundExceptionWhileRequestingPartition()
notSucceededNorCancelledStatusMapsToNonSuccessExitCode()
testCloseBeforeComplete(CheckpointStreamWithResultProvider
testBoundedCollectAndLimit()
testAddTask()
testConcurrentReleaseOperations()
testDateAndTimeAsGenericObject()
testOpenSessionWithEnvironment()
testUDAFMin()
testSerDe()
testStopWithExplicitSavepointType("-t",
testDumpedHistogram()
testHarness.setup(VoidSerializer.INSTANCE);
testStreamTask.getName(),
testNestedSchema()
verifyApplyToAllKeysNotSupported()
testHarness.snapshot(2,
testPymoduleOptionParsing()
testCleanupReleasedPartition(false);
testUtil.addTable("""
testAllApis(">\\'\n<",
testContentAddressableStreamPermanentBlob()
testingSchedulingTopology.connect(ev1,
testCdcCorrelateNonDeterministicFuncNoLeftOutput():
testVersions.add(FlinkVersion.v1_7);
testExceptionWithoutTypeSchema()
testBarrierHandling(SavepointType.savepoint(SavepointFormatType.CANONICAL));
testParameter.extractExecutionConfig(pipeline);
mergeExcludingConstraintsOnDuplicate()
test_tumbling_group_window_over_time(self):
testFullPushdownWithoutWatermarkAssigner():
testAllApis('f3.abs(),
writeToAlreadyExistingCheckpointFails()
testNumDistinctValsWithLargeInputs():
testAddGet()
testAlterTableAddUniqueConstraintEnforced()
testErrorThrownFromSplitEnumerator()
testGateway.getInvocations().take().leaderId());
testConcurrentGetOperations(null,
testStreamTableEnvironmentExecutionExplainWithEnvParallelism():
testPrintOutputFormatWithIdentifierAndPrefix()
testCumulateWindow_Rollup():
testAutomaticWatermarkContext()
testTableApi(12.flatten(),
testGetDirtyResultsWithNoEntry()
testInputStream.getPos();
testReplaceWithNoLeadershipAndDiscardState()
test_count_window(self):
testHarness.processElement1(insertRecord(toUtcTimestampMills(3L,
testShouldRespectMaxContentLengthLimitForRequests()
testAllApis((-'f51).round(-1),
testingLeaderElectionService.isLeader(secondLeaderSessionId);
testLongValues()
testCloseAsyncLookupJoinRunner()
testReflectReadFromGenericRecords()
test.assertEqual(result1['boolean'],
testCoGroupKeyAtomicExpression1()
testRowDataWriteReadWithSchema(ADDRESS_SCHEMA);
test("double",
testPartitionCustomOperatorPreservesFields()
testBacklogConsistentWithNumberOfConsumableBuffers(
testNullableField(SMALLINT(),
testRoundTrip()
testSqlApi("EXTRACT(HOUR
testFailingOnUpdateTaskExecutionStateWithNoRestart()
testJobRecoveryWithFailingTaskExecutor()
testHarness.processElement(2,
testSavepoint(
testNullableField(ARRAY(STRING()),
testAccumulatorTypeStrategy()
testJoinWithPojosWrongType()
testApplyProcessingTimeTime()
testMaxConcurrentAttempts(5);
testPartialInsertWithNotNullColumn():
testCreateUploadDir()
testTieBreaker()
shortGaugeIsConvertedCorrectly()
testWithoutGenerateUpdateBeforeAndInsert()
testLongDescription()
testVarCharLiteral()
testRequestJob(
testHarness.processStreamStatus(1,
testImmediateCacheInvalidationAfterFailure()
testRecoveryWhileJobGraphRecoveryIsScheduledConcurrently()
testCancelPartitionRequest(true);
testModernStateBackendDoesNotTakePrecedence()
testValues(TestSpec
testRemoveShuffleDescriptorCacheAfterFinished(
testFailover()
testInvalidContext()
testJobFailedAndSavepointOperationSucceeds()
testBackOffAttemptResetsWithSuccessfulSubscription()
testDropDb_DatabaseNotExist_Ignore()
testNullableField(Types.VOID,
deletesLocalStateIfRetrievalFails()
testHarness.setStateTtlProcessingTime(30);
testEventTime()
testTrackSizeLimitAndDeleteExcessSequentially()
testEmptyPath()
testDropTable_TableNotExist_ignored()
testExceptionOnSet()
testSuccessfulCheckpointSubsumesUnsuccessful()
testBinaryOp()
testAsyncClientOptionsUtilsExtractingCorrectConfiguration()
buildingBufferMultipleTimes()
testAddOnReleasedPartition(ResultPartitionType
testCallbackCalledOnNodeCreation();
testSerDeIngestionTime()
testSemanticPropsWithKeySelector1()
testWatermarkWithMultiInputUdf():
testWithDirectedRMatGraph()
testBoundaryByteArrayEquals()
testSqlApi(s"CAST(${value(12.2)}
testFlushAboveThreshold()
testSharedStateHasAbsolutePathHandles()
testAllApis('f8.hex(),
testCreatingTypes()
testCallUDFWithNoParam()
testSlotAllocationNoResourceManager()
testGetFinalResultOnUndefinedReconfigureIntermediateCompatibilityResultFails()
testIntervalJoinSideOutputLeftLateData()
testDefaultParallelismOption()
testSkipToLastWithOneOrMore()
testRenamePath()
testGetDynamicProperties()
testAllApis('f21.isTrue,
testCleanupWhenCancelledAfterRestore()
testHarness.setProcessingTime(4);
testDefaultScheduleMode()
testNoTimerFiringForGarbageCollectedMergingWindow(
testSnapshotAsyncCancel()
testReducingStateInstantiation()
testConjunctFutureFailsOnEmptyAndNull()
testGetNioBuffer1()
openCallDeclaresQueueInStandardMode()
testHandleEndInputInStreamingMode(boolean
testRecoveryRegisterAndDownload()
testCollectingSchema()
testReceivingNewBufferSizeBeforeReaderIsCreated()
testHybridSourceWithJobManagerFailover()
testInvalidAtomicConversion()
coLocationConstraintIsResetOnTaskRecovery()
testHistoryFile()
testEntriesIterator()
testHeapNullBuffer1()
test_keyed_co_process_side_output(self):
testRecordIncrementalSplitAssignment()
testBasicArrayKeyRejection()
testExplainPlanFor()
testUploadJarFilesHelper()
testBatchCompressTextTable()
testHarness.getExecutionConfig().setAutoWatermarkInterval(5);
testToByte()
testCorrectTimestampPassingInContext(Long
testNotifyPartitionDataAvailable(
testTypeExtractionTuple()
testUnparsableLongForListShardsBackoffBaseMillisInConfig()
testSnapshotUtilsLifecycle()
testRestoreLatestCheckpointedStateWithChangingParallelism(false);
testJaasModuleFilePath(file.toPath().toString()
testFailingPrimaryWriteArrayOffsFail()
testPersisting(true);
ensureRegisteredAtHookTime()
testLeadLag():
testStartFromSavepoint(
testingFatalErrorHandlerResource.getFatalErrorHandler()
testScheduleWithDelay()
testSqlApi(s"CAST(${decimal_38_18(5.26)}
testHarness.setProcessingTime(1060);
testReturnsUnsigned()
testNullability(rawType);
jobStatusIsRestartingIfOneVertexIsWaitingForRestart()
testCacheSerialization()
testStrictlyMatchingHashPartitioning()
testSendScheduleOrUpdateConsumersMessage(
testEnumAsInt()
testCommit()
testSimplifyHopWindowTVFBeforeWindowJoinWithLeftCalc():
testKeyedAdvancingTimeWithoutElements()
testSerializeIndividually()
testMaxBundleSize()
testCheckpointAndReset()
testGreedyQuantifierAtTheEndIsNotSupported()
testingLeaderRetrievalDriver.onUpdate(
testHybridFullExchangesRestart()
testNoFilterMatchWithWatermark():
testCannotPushDown3WithVirtualColumn()
testAllNullable()
testTableApi(lit(Instant.EPOCH).cast(DataTypes.DATE()),
testPackaging()
testAllApis(1.2345.cast(DataTypes.FLOAT).round(nullOf(DataTypes.INT)),
testJoinHintsWithDuplicatedArgs()
testRow.setField(7,
testDownloadInternal(TriConsumer<CompletedCheckpointStore,
testCheckpointFailsIfSendingEventFailedBeforeTrigger()
testNullableField(RAW(Void.class,
testOnRemovedJobGraphShouldNotProcessUnknownJobGraphs()
testIgnoreParseErrors(TestSpec
testWithRocksDbBackendFull()
testSplittedIF()
testAnonymousInnerTimestampAssigner()
testStartFromEarliestOffsets()
testEventTimeTumbleWindow():
testUDFReturningEmpty()
testArchivedCheckpointingSettingsNotNullIfCheckpointingIsEnabled()
super.testConfigSnapshotInstantiation())
eventsBlockedByClosedGateway()
testFullOuterJoinOnTuplesWithKeyPositions(JoinHint.BROADCAST_HASH_FIRST);
testDecodingDefaultReference()
testKMeans()
testTimesNotStrictWithFollowedByEager()
testConcurrentAttemptsRequestSplits()
testVCoresAreSetCorrectlyAndJobManagerHostnameAreShownInWebInterfaceAndDynamicPropertiesAndYarnApplicationNameAndTaskManagerSlots()
listStatus()
testFencedScheduleWithDelay()
test_aggregating_state(self):
testProcTimeTemporalJoinWithComputedColumnAndPushDown():
testSubmittingJobViaRestClusterClient()
testSpec("dotInUnqualifiedTableName")
testProjectionMaskNested()
testInitUDFWithConstantArguments()
testCancelLeftOuterJoinTaskWhileBuilding()
testInitFile()
testItems.stream().map(item
testRegularRecovery()
testExistingFileDeletion()
testEventTimeTemporalJoinWithComputedColumnAndPushDown():
testStartWithTimes()
testDeserializeListTooShort1()
testWithSimpleGraphWithMinimumScore()
testFactoryHelperWithEnrichmentOptions()
testCoGroupKeyMixing2():
testEmptyFlush()
testGetPartitionStats()
testReverse()
testSerializerTree()
testFromConfigurationIncludeDefault()
testJoinProjectionSemProps1()
testScalaParentFirst()
testMissingJobClassName()
testDisableFilterRestoredParitionsWithAddedTopic()
getKeyedStateStreams()
testFlushThresholdMetBeforeBatchLimitWillCreateASmallerBatchOfSizeAboveThreshold()
testDecrement()
testCompileWriteToFileAndThenExecuteSql()
testBytes()
testDanglingPageRank()
testEqualsHashAndCompareTo()
testEscapeChar()
testScheduleTriggerRequestDuringShutdown()
testWriteReadTooMuchInMemory()
testGetUpsertKeysOnLookupJoin():
testQueryViewWithHints():
testBuildFirstHashFullOutJoin()
testComplexJoin():
testAllApis(-1.tanh(),
testOlderSavepointSubsumed()
testHashTableGrowthWithInsert()
test("float",
testSerializeAsSequenceNoReuse()
testCreateTableAs()
testParams.builderSetup.accept(builder);
testSimpleProjectWithProctime():
testDuplicatedWrite()
testGetAndRemoveUncheckpointedAssignment()
testTupleSupertype()
test_process_function(self):
testSetSSLVersionAndCipherSuitesForSSLServerSocket()
testBeginWithZeroOrMore()
testSortIntStringWithRepeat()
testGroupingID()
testSplit3()));
testAllApis(array('f0,
testPojoSingleOrder()
testMisuseOptimizePointLookupWithMapState()
testRetryWithDelayAndPredicate()
testHandleExceptionWithNormalCompletion()
testCancelAllPendingRequestWhileCanceling()
testCanPushDownLocalSortAggWithSort()
testAddingJob()
appendOverSize()
testElasticsearchSinkWithCbor()
testDataSourceWithRuntimeContext()
testHarness.runUntilAllRecordsEmitted(output,
testStartTGTRenewalShouldScheduleRenewal()
testInvalidProcessReaderFunctionFails()
testEagerlyRegisterNewCompatibleAsIsSerializer()
testExpandOutOfTargetDir(@TempDir
testLogicalSlotAllocation()
testStatsDCountersReportingOfNegativeValues()
testIsAvailable(inputGate,
testWritingNoDataToPartition()
testFetchBeforeWithDifferentSize()
testFailingHashFirstMatchTask()
testInitStatus()
eventsReleasedAfterOpeningGateway()
testOverwriteNonParallelLocalFS()
testClosedButAddRequestAndRegisterListenerRace()
testJoinHintWithTableNameOnly():
testCdcJoinDimWithPkNonDeterministicLocalCondition():
testOnEventTimeContinue()
testDetachedPerJobYarnClusterWithStreamingJob()");
test_legacy_kafka_connector(self):
testCreateNettyAsyncHttpClientHttpVersion()
testCrossProjection4()
testRejectedOnAdditionalLicenseFileInMetaInf(@TempDir
vertexIsNotAffectedByOutdatedDeployment()
testUseDatabaseWithException()
testAsFromTupleByName()
testComputeMemorySize()
testCreateConfigMap()
testBuildFirstAndFullOuterJoin()
streamNameOfSinkMustBeSetToNonEmptyWhenBuilt()
testShutdown()
testAllApis('f4.at(2).at(2),
testRescale(NUM_SLOTS,
testAddFailureHandlingForBadArgumentsException()
testNormalizedKeyReadWriter();
testErrorHandlerIsCalledWhenShutdownCompletesExceptionally()
testCloseBoundedData()
testInputLocalityIsRespectedWithAllToAllEdge()
missingRequiredField()
testGetMaxInputChannelNumForResult(DistributionPattern.ALL_TO_ALL,
testGetWithNullArray()
testSinkCombinations(
testUserData(name,
testRangePartitioningPreserved3()
emptyArrayPutsEmptyValueInConfig()
testExceptionDuringReload()
testWriteAndReadLeaderInformation()
testRequireNonNullNamespace()
testGlobalFailureBeforeCheckpointResetsToEmptyState()
testCheckpointWithMasterAndTaskState(temporaryFolder.newFolder().toURI().toString());
testState2.update("S-"
testIPv6toURL()
test_set_value_serialization_schema(self):
testGetChannelsWithUnprocessedBarriers()
testRemoveBothInvalidVerticesVertexResult()
testAllApis('f0.upperCase(),
parse(sql,
testInputFromAtomicWithPhysicalDeclaredSchema()
testFullOuterStrategy3()
testingJobManagerRunner.getTerminationFuture().get();
testHasCleanJobResultEntryWithDirtyEntry()
readWithEmptyField()
testDetermineParallelismWithMinimumSlots()
testNullExecution()
testPutChunkedStreamSuccessfulGet3()
testTriggerSavepointWithoutCheckpointBaseLocations()
serializeGauge()
testClosesStreamIfReaderCreationFails()
testGetUniqueKeysOnStreamExecChangelogNormalize():
testLatencyMarkEmissionEnabledViaExecutionConfig()
testBernoulliSamplerDuplicateElements()
testCreateNettyAsyncHttpClientWithDefaultsReapIdleConnections()
testDuplicateSerializerWithRegisteredSerializerClass()
testExecuteSqlWithUseDuplicateModuleNames():
testReadInvalidContentsLenient()
testJobMasterGatewayGetsForwarded()
testResultFutureWithSuccessBeforeStart()
testForwardedDual()
testSqlStatements()
testShutdownWithFailureDueToMissingConnection()
testExecutionSlotAllocatorFactory.getTestExecutionSlotAllocator();
testJoinConditionPushDownLeftAnti1()
test_set_bootstrap_severs(self):
testSortPartitionWithKeySelector2()
testCreateSlice1(false);
testCommonToCalcite()
testTableApi(timestampDiff(TimePointUnit.MINUTE,
testSetBuffer()
testAllApis('f18.floor(TimeIntervalUnit.YEAR),
testPrecisionFixing()
testJoinHintWithMultiArgsAndLeftSideFirst()
testSingleTaskNotOccupyingSlotIndefinitely()
testZipWithUniqueId()
testCachedStatsUpdatedAfterRefreshInterval()
testRestoreSerializerWithNewFields()
testUDFJson()
testPropagationDeclineFromCheckpointConfig()
verifyCancelSubmitInSyncMode()
testCreateEntropyAwareEntropyFs()
testAlterFlinkManagedTableToFlinkManagedTable()
testApplyToWithOptionMultipleOptionsAndOneDefaultValue()
testFailureRateRestartStrategySpecifiedInJobConfig()
testingMultipleComponentLeaderElectionDriver.setListener(leaderElectionListener);
testStreamToLastSeenShardStateIsCorrectlySetWhenNewShardsFoundSinceRestoredCheckpointAndSomeStreamsDoNotExist()
testJobExecution()
@SuppressWarnings({"Convert2Lambda",
tester.getProcessingTime()
longMaxInputWatermarkIsForwarded()
testTableHintWithSameOptions():
testGetCredentialsProviderAssumeRole()
testRejectedOnInvalidNoticeFile()
testJavaSerializability(nullType);
testRecoverWorkerFromPreviousAttempt()
testData.add(Tuple2.of(DataTypes.TIMESTAMP(),
testSpec.dataType.bridgedTo(to.getKey());
testFromFlinkTableName()
testDifferentSideOutputTypes()
testGetExecutionSlotSharingGroupOfLateAttachedVertices()
testBlockingPartitionIsConsumableMultipleTimesIfNotReleasedOnConsumption()
testBasicProcessing()
testOnFinishedCallOnEnter()
testVersions.add(MigrationVersion.v1_8);
testUpdateIteratorLess(multiColumnFixedLengthSerializer,
testGetNioBufferReadable(boolean
testConvergenceCriterionWithParameterForIterate()
testDisableFilterRestoredParitionsWithRemovedTopic()
testFullOuterJoinLeftOuterJoin():
testUniformDistribution()
testAllApis('f38
testKeepChangelogNormalizedOnNonUpsertJoin():
testGetReadSet()
testCoGroupKeyExpressions1()
testValueStateInstantiation()
testFailedEntriesAreRetriedInTheNextPossiblePersistRequestAndNoLater()
testMultipleChainedOperators()
testOpenAndCloseInSinkFunction()
testCommandLineMaterialization()
testConfig.setProperty(ProducerConfigConstants.AGGREGATION_MAX_COUNT,
testStreamQueryExecutionLimitedTable()
testWatermarkOnNonExistedField()
testInvalidTimeTypeAvroSchemaConversion()
testUnavailableWhenBuffersExhausted()
test("CHAR")
testJobGraphRemovalFailureAndLockRelease()
testProcessAllWindowState()
testWriteReleasedSortBuffer()
testHarness2.notifyOfCompletedCheckpoint(snapshotCount);
testFinishingOperatorWithException()
testWrapCopyChangingData()
testJobDetailsCompatibleUnmarshalling()
testIterativeWithLoopingStarting(boolean
testNotFollowedByAnyBeforeOneOrMoreEager()
testAllApis('f27.asin(),
testSchemaResolutionErrors()
testNumberOfVertices()
testUnfinishedBufferBehindFinished()
testJoinKeyInvalidAtomic2()
testWriteLargeRecord()
testSingleTableSqlQueryWithOutputType(
testHarness.getOutput().toArray(),
channelSelect()
testIterator(singletonList("value"),
testHarness.setProcessingTime(timestamp);
testConfig.setProperty(SUBSCRIBE_TO_SHARD_TIMEOUT_SECONDS,
testMapOperationMixedWithPandasUDFAndGeneralUDF():
testRewriteInnerClass()
testMultipleInputDecreasingWatermarksYieldsNoOutput()
testPythonFunctionWithMultipleCompositeOutputs():
testJoinProjection4()
testDeserializeValueEmpty()
testProcTimeLeftTemporalJoin():
testGroupNotFollowedBy()
test_avro_union(self):
testStartFromGroupOffsetsWithNoneResetStrategy()
testConvertToHashPartitioner(StreamExchangeMode
testGetChecksForCorruptionInTransientBlobInCaseOfRestart()
testFetchNextInitialState()
testTypeConversionMapperTupleToBasic()
testSkipToFirstWithOptionalMatch()
testHarness.processElement2(updateBeforeRecord(7L,
testDecimalLiteral()
testAllApis("k1=v1,k2=v2".strToMap(),
testGetSourceFieldInvalidIndex()
testConfig.setProperty(AWSConfigConstants.AWS_SECRET_ACCESS_KEY,
testLogicalType()
testAbortCheckpointsAfterEndOfPartitionReceived()
testDuplicatedToken()
testScaleUp()
testNormalizedKeyReadWriter()
testIncludeFieldsErrorWhenExcludingAll()
testWithUnion()
testAppendRowFields()
testFreeReservedSlots(boolean
testJob.jobGraph.getVertices())
testYieldingOperatorProperlyChainedOnNewSources()
testDeserializeParseError()
testSlotSharingGroupWithSpecifiedResources()
testGetCommitRecoverableSerializer()
testMapStateGetKeys()
testUserDefinedVariableOnKeyGroup()
testJobResultRetrieval()
testJobMasterRejectsTaskExecutorRegistrationIfJobIdsAreNotEqual()
testMissingFieldWithKeyedState()
testJobName(
testSerialSplitAssignmentSomeForRemoteHost()
testTimesRangeNonStrictOptional2()
testHarness.processElement(StreamStatus.ACTIVE,
testUpdateBinaryRepresentations()
testWithIntPair()
testLeftProcTimeTemporalJoinWithStateRetention()
myTest()
testMultiThreadedAddGet()
testIncrementalRehash()
testPhysicallyRemoveWithGet()
shouldProperlyConstructTemporaryBlobIdentifierWithDefaultBucket()
testJobRecoversAfterKillingTaskManager()
testAsWithNonFieldReference2()
testSerializerSnapshot.resolveSchemaCompatibility(newTestSerializer);
testFutureBecomesAvailableAfterNotifyAvailable()
testInstance.getJobMasterGateway().get())
testingAllocatedSlotActions.setReleaseSlotConsumer(
checkPropertyHandlingWithIncreasingGlobalParallelism1()
testAllApis('f20
testSumAbsDiff()
testOnCheckpointMultiplePendingFiles(@TempDir
testCreatedMapperPassedToSchemaFunction()
pollNextReturnMoreAvailableWhenAllSplitFetcherCloseWithLeftoverElementInQueue()
testFieldDeserialization(INT(),
testDeserializationSchemaWithOptionalProperties()
testCorrectnessOfDefaultCross()
testSortPartitionByTwoFieldExpressions()
testRepeatedParentFirstPatternClass()
testUseDatabaseAndShowCurrentDatabase()
testNoQuery()
testJobMasterConnectionTerminationAfterExternalPromotion()
testForwardedInvalidExpression()
testMapEdgesType()
test_all_modules()
testHarnessForProcessFunction()
testVerboseErrorMessage()
testExecutorFactory()
testRestoreApplyProcessingTimeWindows()
testCloseAfterSubmitPriority()
testDeletePartitionFileOfBoundedBlockingShuffle()
testCancelDataSinkTask()
testPatternWithSubtyping()
testResumeConsumption()
testSimpleMetadataAccess():
testSerializationDeserialization()
